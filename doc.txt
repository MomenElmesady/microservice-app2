--------- ONE-TO-ONE --------

1ï¸âƒ£ User A sends a message  
â”œâ”€â”€> Chat Service (via WebSocket or API)  
â”œâ”€â”€> Auth Check (Chat Service -> User Service) âœ…  
â”œâ”€â”€> Check if User B is online (Redis)  
2ï¸âƒ£ If online:  
â”œâ”€â”€> Send message via WebSocket  
3ï¸âƒ£ If offline:  
â”œâ”€â”€> Save message in DB  
â”œâ”€â”€> Notify Notification Service  
â”œâ”€â”€> Push notification to User B  
4ï¸âƒ£ When User B comes online:  
â”œâ”€â”€> Chat Service fetches unread messages  
â”œâ”€â”€> Messages sent to User B  
â”œâ”€â”€> Messages marked as "delivered"  

            FULL-STACK
[Frontend] 
â”‚
â”œâ”€â”€ 1ï¸âƒ£ User connects to WebSocket (ws://chat-service)
â”‚
â”œâ”€â”€ 2ï¸âƒ£ User sends message (emit "send_message" event)
â”‚       { senderId: 1, receiverId: 2, message: "Hey!" }
â”‚
â”œâ”€â”€ 3ï¸âƒ£ Chat Service checks if receiver is online
â”‚       â”œâ”€â”€ âœ… If Online â†’ Delivers via WebSocket ("receive_message")
â”‚       â”œâ”€â”€ âŒ If Offline â†’ Stores in DB, triggers Notification Service
â”‚
â”œâ”€â”€ 4ï¸âƒ£ Receiver gets push notification (if offline)
â”‚
â”œâ”€â”€ 5ï¸âƒ£ Receiver reconnects â†’ Fetches unread messages via WebSocket

            IF NEED RECONNECT ON PUSH Notification

[Frontend]  
  â”‚  
  â”œâ”€â”€ 1ï¸âƒ£ User connects to WebSocket (ws://chat-service) // every time open the app open new connection and store in redis
  â”‚       â”œâ”€â”€ Sends "join" event â†’ { userId: 1 }  
  â”‚       â”œâ”€â”€ Chat Service stores socket ID in Redis  
  â”‚  
  â”œâ”€â”€ 2ï¸âƒ£ User sends message (emit "send_message" event)  
  â”‚       { senderId: 1, receiverId: 2, message: "Hey!" }  
  â”‚  
  â”‚  
[Chat Service]  
  â”‚  
  â”œâ”€â”€ 3ï¸âƒ£ Validates sender authentication  
  â”‚       â”œâ”€â”€ âœ… If token is valid â†’ Proceed  
  â”‚       â”œâ”€â”€ âŒ If invalid â†’ Emit "error" event (Unauthorized)  
  â”‚  
  â”œâ”€â”€ 4ï¸âƒ£ Checks if receiver is online (Redis lookup)  
  â”‚       â”œâ”€â”€ âœ… If Online â†’ Delivers via WebSocket ("receive_message")  
  â”‚       â”œâ”€â”€ âŒ If Offline â†’ Stores message in DB, triggers Notification Service  
  â”‚  
  â”œâ”€â”€ 5ï¸âƒ£ Saves message to DB (status: delivered/undelivered)  
  â”‚  
  â”‚  
[Notification Service]  
  â”‚  
  â”œâ”€â”€ 6ï¸âƒ£ If receiver is offline â†’ Sends push notification  
  â”‚       â”œâ”€â”€ Using Firebase/APNS (mobile)  
  â”‚       â”œâ”€â”€ Using Web Notifications (browser)  
  â”‚  
  â”‚  
[Frontend (Receiver)]  
  â”‚  
  â”œâ”€â”€ 7ï¸âƒ£ Receiver gets push notification (if offline)  
  â”‚  
  â”œâ”€â”€ 8ï¸âƒ£ Receiver reconnects â†’ Fetches unread messages via WebSocket  
  â”‚       â”œâ”€â”€ Emit "fetch_unread_messages"  
  â”‚       â”œâ”€â”€ Chat Service returns stored messages from DB  
  â”‚  
  â”œâ”€â”€ 9ï¸âƒ£ Marks messages as "read" in DB  
  â”‚  
  â”œâ”€â”€ ğŸ”„ Chat continues in real-time  


--------- ONE-TO-GROUP --------

Cloudinary 